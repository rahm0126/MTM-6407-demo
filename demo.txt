These are the edits I made.
I made them in the second-branch.